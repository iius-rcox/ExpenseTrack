# Implementation Plan: Frontend Integration Tests

**Branch**: `022-frontend-integration-tests` | **Date**: 2026-01-02 | **Spec**: [spec.md](./spec.md)
**Input**: Feature specification from `/specs/022-frontend-integration-tests/spec.md`

## Summary

Add comprehensive frontend integration testing to close critical gaps in the testing suite. The current tests mock dependencies too aggressively, hiding real integration failures that caused production issues (login not redirecting, analytics page crashing). This feature introduces:

1. **Authentication flow E2E tests** - Validate login/logout/redirect using MSAL test utilities
2. **Analytics page integration tests** - Test with realistic API responses via MSW
3. **API contract validation** - Ensure frontend types match backend OpenAPI spec
4. **Route-level tests** - Verify all pages render without errors
5. **Error boundaries** - Graceful degradation when components crash

## Technical Context

**Language/Version**: TypeScript 5.7+ with React 18.3+
**Primary Dependencies**: Vitest 4.x, Playwright 1.57+, MSW (Mock Service Worker), TanStack Query, TanStack Router
**Storage**: N/A (testing infrastructure only)
**Testing**: Vitest (unit/integration), Playwright (E2E), MSW (API mocking)
**Target Platform**: Node.js for test runners, browsers for E2E
**Project Type**: Web application (frontend testing enhancement)
**Performance Goals**: Test suite adds <3 minutes to CI pipeline
**Constraints**: Must work with existing MSAL authentication, existing CI workflows
**Scale/Scope**: ~10 authenticated routes, 6 analytics API endpoints, 1 auth flow

## Constitution Check

*GATE: Must pass before Phase 0 research. Re-check after Phase 1 design.*

| Principle | Status | Notes |
|-----------|--------|-------|
| I. Clean Architecture | ✅ N/A | Testing infrastructure, not application code |
| II. Test-First Development | ✅ ALIGNED | This feature directly supports test-first by adding missing test coverage |
| III. ERP Integration | ✅ N/A | No Vista integration in frontend tests |
| IV. API Design | ✅ ALIGNED | Contract tests validate OpenAPI compliance |
| V. Observability | ✅ ALIGNED | Test reporting visible in CI (FR-011) |
| VI. Security | ✅ ALIGNED | Auth flow testing validates security integration |

**Gate Result**: ✅ PASSED - No violations. Feature directly supports Constitution Principle II.

## Project Structure

### Documentation (this feature)

```text
specs/022-frontend-integration-tests/
├── spec.md              # Feature specification
├── plan.md              # This file
├── research.md          # Phase 0: Research findings
├── data-model.md        # Phase 1: Test fixture schemas
├── quickstart.md        # Phase 1: Developer setup guide
├── contracts/           # Phase 1: API contract definitions
│   └── openapi-subset.yaml  # Subset of backend OpenAPI for frontend validation
└── tasks.md             # Phase 2: Implementation tasks (generated by /speckit.tasks)
```

### Source Code (repository root)

```text
frontend/
├── src/
│   ├── components/
│   │   └── error-boundary/     # NEW: Error boundary components
│   ├── test-utils/             # NEW: Shared test utilities
│   │   ├── msw-handlers.ts     # MSW request handlers
│   │   ├── auth-mock.ts        # MSAL test utilities
│   │   └── render-with-providers.tsx
│   └── ...
├── tests/
│   ├── setup.ts                # MODIFY: Add MSW setup
│   ├── unit/                   # Existing unit tests
│   ├── integration/            # NEW: Page-level integration tests
│   │   ├── analytics.test.tsx
│   │   ├── dashboard.test.tsx
│   │   ├── transactions.test.tsx
│   │   └── ...
│   ├── e2e/
│   │   ├── auth-flow.spec.ts   # NEW: Authentication E2E
│   │   └── ...
│   └── contracts/              # NEW: Contract validation tests
│       └── api-contracts.test.ts
└── vitest.config.ts            # MODIFY: Add integration test config
```

**Structure Decision**: Extends existing frontend test structure. New directories:
- `src/test-utils/` for shared testing utilities
- `tests/integration/` for page-level tests with MSW
- `tests/contracts/` for API contract validation
- `src/components/error-boundary/` for error handling components

## Complexity Tracking

No constitution violations to justify. Feature adds testing infrastructure only.
